# Merge PDF 输入框工具需求文档

## 1. 文档目的
本文档用于定义一个 **仅通过输入框完成操作的 Merge PDF 工具** 的功能需求与交互规则。该工具需兼容以下三类功能场景：
- Merge PDF for printing
- Merge PDF keep bookmarks
- Merge PDF by page range

本阶段不涉及多页面、多板块或复杂 UI，仅设计**输入框驱动的单页工具**。

---

## 2. 产品范围与约束

### 2.1 范围
- 支持多个 PDF 文件合并为单一 PDF
- 所有操作均通过“输入框 + 上传文件”完成
- 输出为单一合并后的 PDF 文件

### 2.2 明确不包含
- 不设计额外功能板块（如设置页、历史记录页）
- 不涉及账户系统
- 不涉及编辑、拆分、压缩等非合并功能

---

## 3. 核心功能需求

### 3.1 文件输入

#### 3.1.1 文件上传
- 支持一次上传多个 PDF 文件
- 上传顺序即为默认合并顺序
- 仅允许 PDF 格式

#### 3.1.2 文件识别
系统需自动识别：
- 每个 PDF 的总页数
- 是否包含书签（Outline）
- 是否为加密 PDF（如是则拒绝并提示）

---

## 4. 输入框设计（核心）

### 4.1 输入框定位
- 页面仅包含一个主输入框
- 输入框用于**输入合并规则指令**
- 类似“命令式配置”，无需额外控件

---

### 4.2 输入框语法定义

#### 4.2.1 基础语法结构

```
[file_index]:[page_range] [options]
```

- `file_index`：上传文件的顺序编号（从 1 开始）
- `page_range`：页码范围（可选）
- `options`：合并模式控制参数（可选）

---

### 4.3 Merge PDF by Page Range（页码范围合并）

#### 4.3.1 功能说明
允许用户指定每个 PDF 文件参与合并的页码范围。

#### 4.3.2 支持的页码格式
- 单页：`3`
- 连续页：`1-5`
- 离散页：`1,3,7`
- 混合：`1-3,6,9-12`

#### 4.3.3 示例
```
1:1-3
2:5-8
3:1,4,6
```

---

### 4.4 Merge PDF for Printing（打印友好合并）

#### 4.4.1 功能目标
生成适合连续打印的 PDF，避免打印中断和结构混乱。

#### 4.4.2 行为定义
- 按输入顺序线性合并页面
- 自动移除空白尾页（如可识别）
- 不插入额外封面页
- 保持页面尺寸与方向原样

#### 4.4.3 启用方式
```
--print
```

---

### 4.5 Merge PDF Keep Bookmarks（保留书签）

#### 4.5.1 功能说明
在合并 PDF 时，保留原始 PDF 中的书签结构。

#### 4.5.2 合并规则
- 每个源 PDF 的书签作为一级书签节点
- 书签标题默认为文件名
- 原有多级书签结构保持不变
- 页码根据合并后位置重映射

#### 4.5.3 启用方式
```
--keep-bookmarks
```

---

## 5. 输入框组合规则

```
1:1-4
2:3-10
3:all
--print
--keep-bookmarks
```

---

## 6. 校验与错误处理
- 校验文件编号是否存在
- 校验页码是否超出范围
- 校验格式合法性

---

## 7. 输出结果要求
- 输出单一 PDF 文件
- 默认文件名：merged.pdf
- 书签在标准 PDF 阅读器中正确显示

---

## 8. 非功能性需求
- 大文件不崩溃
- 输入解析安全
