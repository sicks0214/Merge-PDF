# Merge PDF å·¥å…·é¡µæŠ€æœ¯æ–‡æ¡£ v3.1

> æœ¬æ–‡æ¡£ä¸º Merge PDF æ’ä»¶åŒ–å·¥å…·ç«™çš„æŠ€æœ¯æ ‡å‡†ã€‚
> å‰ç«¯ã€åç«¯ã€æ’ä»¶ç³»ç»Ÿã€SEO å®Œæ•´è¦†ç›–ã€‚

---

# 0. å·¥å…·é¡µæ ¸å¿ƒæ¦‚å¿µ

**å·¥å…·é¡µä¸æ˜¯ç¡¬ç¼–ç é¡µé¢**ï¼Œæ‰€æœ‰å†…å®¹æ¥è‡ªæ’ä»¶ç³»ç»Ÿçš„ 3 ä¸ª JSONï¼š

| æ–‡ä»¶          | ä½œç”¨                                | å·¥å…·é¡µæ˜¯å¦ä¾èµ–ï¼Ÿ |
| ------------- | ----------------------------------- | ---------------- |
| plugin.json   | å·¥å…·åŸºç¡€ä¿¡æ¯ï¼ˆslug/category/apiPathï¼‰ | âœ” å¿…é¡»           |
| ui.json       | æ ‡é¢˜ã€æè¿°ã€FAQã€SEOã€å¤šè¯­è¨€æ–‡æ¡ˆ      | âœ” å¿…é¡»           |
| schema.json   | å·¥å…· UI ç»“æ„ï¼ˆä¸Šä¼ ã€é€‰é¡¹ã€æŒ‰é’®ï¼‰      | âœ” å¿…é¡»           |

å·¥å…·é¡µçš„ä»»åŠ¡ï¼š

âœ” æ ¹æ® URL è§£æ slug / category / locale
âœ” è°ƒç”¨æ’ä»¶ç³»ç»Ÿ API è·å–æ’ä»¶æ•°æ®
âœ” æ ¹æ® schema.json åŠ¨æ€æ¸²æŸ“é€‰é¡¹
âœ” æ ¹æ® ui.json æ¸²æŸ“æ ‡é¢˜ã€æè¿°ã€FAQ
âœ” æ ¹æ® plugin.json è§¦å‘ API è°ƒç”¨
âœ” SEO è‡ªåŠ¨ç”Ÿæˆ

---

# 1. è·¯ç”±ç»“æ„

```
/{locale}/{categoryId}/{slug}

ç¤ºä¾‹ï¼š
/zh/pdf-tools/merge-pdf
/en/pdf-tools/merge-pdf
```

| å‚æ•°       | è¯´æ˜              | ç¤ºä¾‹                      |
| ---------- | ----------------- | ------------------------- |
| locale     | è¯­è¨€ä»£å·          | en / zh                   |
| categoryId | å·¥å…·åˆ†ç±»          | pdf-tools                 |
| slug       | å·¥å…·å”¯ä¸€æ ‡è¯†      | merge-pdf                 |

---

# 2. ç›®å½•ç»“æ„

```
Merge-PDF/
â”œâ”€â”€ backend/                              # Express.js åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app.ts                       # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ plugin-loader.ts             # æ’ä»¶åŠ è½½å™¨
â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚       â”œâ”€â”€ plugins.ts               # æ’ä»¶ç®¡ç† API
â”‚   â”‚       â”œâ”€â”€ dynamic.ts               # åŠ¨æ€è·¯ç”±ç”Ÿæˆ
â”‚   â”‚       â””â”€â”€ pdf.ts                   # PDF å¤„ç†
â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â””â”€â”€ pdf-merge/                   # PDF åˆå¹¶æ’ä»¶
â”‚   â”‚       â”œâ”€â”€ plugin.json              # æ’ä»¶é…ç½®
â”‚   â”‚       â”œâ”€â”€ schema.json              # æ•°æ®æ¨¡å¼å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ ui.json                  # UI æ–‡æœ¬å’Œé…ç½®
â”‚   â”‚       â””â”€â”€ handler/                 # å¤„ç†å‡½æ•°
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/pdf-tools/                  # Next.js 14 å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/[locale]/                # å›½é™…åŒ–è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx               # æ ¹å¸ƒå±€
â”‚   â”‚   â”‚   â””â”€â”€ [category]/[slug]/       # åŠ¨æ€å·¥å…·é¡µé¢
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx             # é¡µé¢ç»„ä»¶ï¼ˆSSRï¼‰
â”‚   â”‚   â”œâ”€â”€ components/                  # React ç»„ä»¶åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ ToolClient.tsx           # ä¸»å·¥å…·å®¢æˆ·ç«¯ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ CoreToolArea.tsx         # æ–‡ä»¶ä¸Šä¼ å’Œå¤„ç†åŒºåŸŸ
â”‚   â”‚   â”‚   â”œâ”€â”€ UseCaseCards.tsx         # ç”¨ä¾‹é€‰é¡¹å¡ç‰‡ï¼ˆåŠ¨æ€æ¸²æŸ“ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ ResultPage.tsx           # ç»“æœå±•ç¤ºé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ HowToSection.tsx         # æ“ä½œæŒ‡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ FAQSection.tsx           # å¸¸è§é—®é¢˜
â”‚   â”‚   â”‚   â”œâ”€â”€ InlineFeedback.tsx       # åé¦ˆæç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ Breadcrumb.tsx           # é¢åŒ…å±‘å¯¼èˆª
â”‚   â”‚   â”‚   â”œâ”€â”€ SchemaRenderer.tsx       # åŠ¨æ€è¡¨å•æ¸²æŸ“å™¨
â”‚   â”‚   â”‚   â””â”€â”€ layout/
â”‚   â”‚   â”‚       â”œâ”€â”€ Header.tsx           # é¡µå¤´
â”‚   â”‚   â”‚       â””â”€â”€ Footer.tsx           # é¡µè„š
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts                   # åç«¯ API è°ƒç”¨
â”‚   â”‚   â”‚   â””â”€â”€ pdfMerger.ts             # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ types/index.ts               # TypeScript ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ docs/                                # æ–‡æ¡£
â””â”€â”€ docker-compose.yml                   # Docker ç¼–æ’
```

---

# 3. å·¥å…·é¡µé¡µé¢ç»“æ„ï¼ˆUI Blueprintï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Header            â”‚  Merge PDF å“ç‰Œ + è¯­è¨€åˆ‡æ¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Home > Merge PDF > å½“å‰å·¥å…· â”‚  Breadcrumb
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Iconï¼ˆemojiï¼‰             â”‚
â”‚   H1 æ ‡é¢˜                   â”‚
â”‚   æè¿°ï¼ˆsubtitleï¼‰          â”‚
â”‚   ç‰¹æ€§ï¼ˆfeaturesï¼‰          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CoreToolArea               â”‚
â”‚   â”œ ä¸Šä¼ åŒºåŸŸï¼ˆæ‹–æ‹½/ç‚¹å‡»ï¼‰   â”‚
â”‚   â”œ æ–‡ä»¶åˆ—è¡¨ï¼ˆå¯æ’åºï¼‰      â”‚
â”‚   â”œ é¡µé¢èŒƒå›´è¾“å…¥            â”‚
â”‚   â”” æäº¤æŒ‰é’®                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ResultPageï¼ˆåˆå¹¶æˆåŠŸåï¼‰   â”‚
â”‚   â”œ ä¸‹è½½æŒ‰é’®                â”‚
â”‚   â”” é‡æ–°å¼€å§‹                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UseCaseCardsï¼ˆåŠ¨æ€æ¸²æŸ“ï¼‰   â”‚
â”‚   â”” ä» schema.options ç”Ÿæˆ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  HowToSection               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FAQSection                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Footer            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# 4. æ’ä»¶é…ç½®æ–‡ä»¶

## 4.1 plugin.json

```json
{
  "name": "Merge PDF",
  "slug": "merge-pdf",
  "category": "pdf",
  "apiPath": "/api/pdf/merge-pdf",
  "order": 1
}
```

## 4.2 schema.json

```json
{
  "upload": {
    "multiple": true,
    "types": ["application/pdf"],
    "maxSize": 104857600,
    "maxFiles": 20
  },
  "options": [
    {
      "name": "optimizeForPrint",
      "type": "checkbox",
      "default": false,
      "useCaseKey": "printing",
      "label": { "en": "Optimize for Print", "zh": "ä¼˜åŒ–æ‰“å°" }
    },
    {
      "name": "keepBookmarks",
      "type": "checkbox",
      "default": false,
      "useCaseKey": "bookmarks",
      "label": { "en": "Keep Bookmarks", "zh": "ä¿ç•™ä¹¦ç­¾" }
    },
    {
      "name": "usePageRange",
      "type": "checkbox",
      "default": false,
      "useCaseKey": "pageRange",
      "label": { "en": "Use Page Range", "zh": "ä½¿ç”¨é¡µé¢èŒƒå›´" }
    }
  ],
  "submitText": {
    "en": "Merge PDF Files",
    "zh": "åˆå¹¶ PDF æ–‡ä»¶"
  },
  "outputType": "file"
}
```

**å…³é”®å­—æ®µè¯´æ˜ï¼š**
- `useCaseKey`: å…³è” ui.json ä¸­çš„ useCases å±•ç¤ºå†…å®¹ï¼Œç”¨äºåŠ¨æ€æ¸²æŸ“ UseCaseCards

## 4.3 ui.json ç»“æ„

```json
{
  "categoryName": { "en": "Merge PDF", "zh": "åˆå¹¶ PDF" },
  "title": { "en": "...", "zh": "..." },
  "description": { "en": "...", "zh": "..." },
  "h1": { "en": "...", "zh": "..." },
  "icon": "ğŸ“„",
  "subtitle": { "en": "...", "zh": "..." },
  "features": { "en": "...", "zh": "..." },
  "breadcrumb": {
    "home": { "en": "Home", "zh": "é¦–é¡µ" },
    "current": { "en": "Merge PDF", "zh": "åˆå¹¶ PDF" }
  },
  "upload": { ... },
  "fileList": { ... },
  "actions": { ... },
  "feedback": { ... },
  "useCases": {
    "sectionTitle": { "en": "...", "zh": "..." },
    "printing": {
      "title": { "en": "...", "zh": "..." },
      "description": { "en": "...", "zh": "..." },
      "features": { "1": {...}, "2": {...}, "3": {...} },
      "action": { "en": "...", "zh": "..." }
    },
    "bookmarks": { ... },
    "pageRange": { ... }
  },
  "howTo": { ... },
  "faq": { ... },
  "result": { ... },
  "footer": { ... }
}
```

---

# 5. æ ¸å¿ƒç»„ä»¶

## 5.1 page.tsxï¼ˆSSR é¡µé¢ï¼‰

è·¯å¾„ï¼š`frontend/pdf-tools/src/app/[locale]/[category]/[slug]/page.tsx`

èŒè´£ï¼š
1. è§£æ URL å‚æ•°ï¼ˆlocale, category, slugï¼‰
2. è°ƒç”¨æ’ä»¶ API è·å–æ•°æ®
3. ç”Ÿæˆ SEO å…ƒä¿¡æ¯
4. æ¸²æŸ“ ToolClient ç»„ä»¶

```typescript
export async function generateMetadata({ params }: PageProps): Promise<Metadata> {
  const { locale, category, slug } = await params;
  const plugin = await fetchPluginData(slug, locale);
  // è¿”å› SEO å…ƒä¿¡æ¯
}

export default async function ToolPage({ params }: PageProps) {
  const { locale, category, slug } = await params;
  const plugin = await fetchPluginData(slug, locale);
  if (!plugin) notFound();

  return <ToolClient pluginData={plugin} locale={locale} categoryId={category} slug={slug} />;
}
```

## 5.2 ToolClient.tsxï¼ˆæ ¸å¿ƒå®¢æˆ·ç«¯ç»„ä»¶ï¼‰

è·¯å¾„ï¼š`frontend/pdf-tools/src/components/ToolClient.tsx`

èŒè´£ï¼š
1. ä» schema.options åŠ¨æ€åˆå§‹åŒ–é€‰é¡¹çŠ¶æ€
2. ä» ui.categoryName åŠ¨æ€è·å–åˆ†ç±»åç§°
3. ç®¡ç†æ–‡ä»¶åˆ—è¡¨ã€ä¸Šä¼ ã€åˆ†æã€æ’åº
4. è°ƒç”¨åç«¯ API è¿›è¡Œåˆå¹¶
5. æ˜¾ç¤ºç»“æœå’Œåé¦ˆ

**å…³é”®ä»£ç ï¼š**
```typescript
// åŠ¨æ€åˆå§‹åŒ–é€‰é¡¹çŠ¶æ€
const initialOptions = useMemo(() => {
  const opts: Record<string, any> = {};
  pluginData.schema?.options?.forEach(opt => {
    opts[opt.name] = opt.default ?? false;
  });
  return opts;
}, [pluginData.schema]);

// åŠ¨æ€è·å–åˆ†ç±»åç§°
const categoryName = pluginData.ui?.categoryName?.[locale]
  || pluginData.ui?.categoryName?.['en']
  || categoryId;
```

## 5.3 UseCaseCards.tsxï¼ˆåŠ¨æ€é€‰é¡¹å¡ç‰‡ï¼‰

è·¯å¾„ï¼š`frontend/pdf-tools/src/components/UseCaseCards.tsx`

èŒè´£ï¼š
1. ä» schema.options è¯»å–é€‰é¡¹åˆ—è¡¨
2. è¿‡æ»¤æœ‰ useCaseKey çš„é€‰é¡¹
3. ä» ui.useCases[useCaseKey] è¯»å–å±•ç¤ºå†…å®¹
4. åŠ¨æ€æ¸²æŸ“é€‰é¡¹å¡ç‰‡

**å…³é”®ä»£ç ï¼š**
```typescript
interface UseCaseCardsProps {
  schemaOptions: PluginSchemaOption[];
  options: Record<string, any>;
  onOptionsChange: (options: Record<string, any>) => void;
  ui: PluginUI;
  locale: string;
}

// åŠ¨æ€æ¸²æŸ“
{schemaOptions.filter(opt => opt.useCaseKey).map(opt => {
  const useCaseData = ui.useCases?.[opt.useCaseKey!];
  return <CardItem>...</CardItem>;
})}
```

---

# 6. API ç«¯ç‚¹

| ç«¯ç‚¹                           | æ–¹æ³• | è¯´æ˜               |
| ------------------------------ | ---- | ------------------ |
| `/api/health`                  | GET  | å¥åº·æ£€æŸ¥           |
| `/api/plugins`                 | GET  | è·å–æ‰€æœ‰æ’ä»¶åˆ—è¡¨   |
| `/api/plugins/:slug`           | GET  | è·å–å•ä¸ªæ’ä»¶é…ç½®   |
| `/api/pdf/merge-pdf`           | POST | åˆå¹¶ PDF æ–‡ä»¶      |
| `/api/pdf/merge-pdf/analyze`   | POST | åˆ†æ PDF æ–‡ä»¶      |

## API è°ƒç”¨æ ¼å¼

```typescript
// åˆå¹¶ PDF
POST /api/pdf/merge-pdf
Content-Type: multipart/form-data

FormData:
- files[]: PDF æ–‡ä»¶ï¼ˆå¤šä¸ªï¼‰
- options: JSON å­—ç¬¦ä¸² { keepBookmarks, optimizeForPrint, usePageRange }
- pageRanges: JSON å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼‰

Response: Blob (application/pdf)
```

---

# 7. ç±»å‹å®šä¹‰

è·¯å¾„ï¼š`frontend/pdf-tools/src/types/index.ts`

```typescript
export interface PluginSchemaOption {
  name: string;
  type: 'boolean' | 'number' | 'text' | 'select' | 'checkbox';
  default?: any;
  useCaseKey?: string;  // å…³è” ui.useCases çš„ key
  label: { [lang: string]: string };
  choices?: Array<{ value: string; label: { [lang: string]: string } }>;
}

export interface PluginSchema {
  upload: { multiple: boolean; types: string[]; maxSize: number; maxFiles: number };
  options: PluginSchemaOption[];
}

export interface PluginData {
  config: PluginConfig;
  ui: PluginUI;
  schema: PluginSchema;
}
```

---

# 8. å›½é™…åŒ–ï¼ˆi18nï¼‰

å·¥å…·é¡µé¢æ‰€æœ‰å†…å®¹æ¥è‡ªæ’ä»¶ JSONï¼š

- title / description / h1 / subtitle / features
- breadcrumb
- upload / fileList / actions / feedback
- useCasesï¼ˆåŠ¨æ€é€‰é¡¹å¡ç‰‡ï¼‰
- howTo / faq / result / footer

å‰ç«¯é€šè¿‡ `locale` å‚æ•°è‡ªåŠ¨åˆ‡æ¢è¯­è¨€ï¼š
```typescript
const getLocalizedText = (obj: any) => {
  return obj?.[locale] || obj?.['en'] || '';
};
```

---

# 9. ä¸‹è½½æ–‡ä»¶å‘½åè§„åˆ™

```
{slug}-pdf-tools-{timestamp}.pdf

ç¤ºä¾‹ï¼šmerge-pdf-pdf-tools-1703520000000.pdf
```

---

# 10. å·¥å…·é¡µé¢å‡†åˆ™

âœ” å·¥å…·é¡µå¿…é¡»å®Œå…¨ä¾èµ–æ’ä»¶ç³»ç»Ÿ
âœ” ä¸å…è®¸ç¡¬ç¼–ç ä»»ä½•å·¥å…·åç§°
âœ” ä¸å…è®¸ç¡¬ç¼–ç åˆ†ç±»åç§°ï¼ˆä» ui.categoryName è¯»å–ï¼‰
âœ” slug ä¸å­˜åœ¨ â†’ 404
âœ” ui.json å†³å®šæ‰€æœ‰æ–‡æ¡ˆ
âœ” schema.json å†³å®šé€‰é¡¹ç»“æ„
âœ” schema.options.useCaseKey å…³è” ui.useCases å±•ç¤ºå†…å®¹
âœ” plugin.json å†³å®š API path

**å·¥å…·é¡µ = "è¯»æ’ä»¶ â†’ åŠ¨æ€æ¸²æŸ“" çš„çº¯å±•ç¤ºå±‚**

---

# 11. æ·»åŠ æ–°æ’ä»¶æ­¥éª¤

1. åœ¨ `backend/plugins/` åˆ›å»ºæ–°ç›®å½•ï¼ˆå¦‚ `pdf-split`ï¼‰
2. æ·»åŠ  `plugin.json`ï¼šå®šä¹‰ name, slug, category, apiPath
3. æ·»åŠ  `schema.json`ï¼šå®šä¹‰ upload, optionsï¼ˆå« useCaseKeyï¼‰, submitText
4. æ·»åŠ  `ui.json`ï¼šå®šä¹‰æ‰€æœ‰å¤šè¯­è¨€æ–‡æ¡ˆï¼ŒåŒ…æ‹¬ useCases
5. æ·»åŠ  `handler/index.ts`ï¼šå®ç°å¤„ç†å‡½æ•°
6. é‡å¯åç«¯ï¼Œç³»ç»Ÿè‡ªåŠ¨åŠ è½½å’Œæ³¨å†Œè·¯ç”±
7. å‰ç«¯æ— éœ€ä¿®æ”¹ï¼Œè‡ªåŠ¨æ”¯æŒæ–°æ’ä»¶

---

# 12. æŠ€æœ¯æ ˆ

| å±‚çº§       | æŠ€æœ¯                | ç‰ˆæœ¬     |
| ---------- | ------------------- | -------- |
| å‰ç«¯æ¡†æ¶   | Next.js             | 14.2.x   |
| å‰ç«¯åº“     | React               | 18.3.x   |
| æ ·å¼       | Tailwind CSS        | 3.4.x    |
| å›½é™…åŒ–     | next-intl           | 3.22.x   |
| æ–‡ä»¶ä¸Šä¼    | react-dropzone      | 14.2.x   |
| åç«¯æ¡†æ¶   | Express.js          | 4.18.x   |
| PDF å¤„ç†   | pdf-lib             | 1.17.x   |
| è¯­è¨€       | TypeScript          | 5.x      |
